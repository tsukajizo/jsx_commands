doShirowaku()function doShirowaku(){    var folder = Folder.selectDialog('画像があるフォルダを選択してください');    if(!folder) return;    var files = folder.getFiles (/jpe?g/);    if( files.length == 0 ) return;         var dir = new Folder(folder.fullName + '_white');    if (! dir.exists) dir.create();        for(var i = 0; i < files.length; i++){        var file = files[i];        app.open(file);        shirowaku (app.activeDocument)                var exportPath = dir.fullName + '/' + file.name        saveAsJpeg (app, exportPath)        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);    }}function saveAsJpeg(app,path){    var file_obj = new File(path);    var jpg_opt = new JPEGSaveOptions();    jpg_opt.embedColorProfile = true;    jpg_opt.quality = 12;    jpg_opt.formatOptions = FormatOptions.PROGRESSIVE;    jpg_opt.scans = 3;    jpg_opt.matte = MatteType.NONE;    app.activeDocument.saveAs(file_obj, jpg_opt, true, Extension.LOWERCASE);}function shirowaku(doc){    var bg = doc.layers.length;    doc.layers[bg-1].isBackgroundLayer = false;    var docWidth = doc.width;    var docHeight = doc.height;    var newDocWidth = docWidth;    var newDocHeight = docHeight;    if(docHeight > docWidth){        newDocWidth = docHeight    } else {        newDocHeight = docWidth    }    doc.resizeCanvas( newDocWidth, newDocHeight);    var layer =  doc.artLayers.add()    layer.name = "backgroundLayer"    var colorObject = new SolidColor();    colorObject.rgb.red = 255;    colorObject.rgb.green = 255;    colorObject.rgb.blue = 255;    doc.selection.selectAll();    doc.selection.fill(colorObject);    doc.selection.deselect();    doc.layers.getByName(layer.name).move(doc.layers[1],ElementPlacement.PLACEAFTER); }